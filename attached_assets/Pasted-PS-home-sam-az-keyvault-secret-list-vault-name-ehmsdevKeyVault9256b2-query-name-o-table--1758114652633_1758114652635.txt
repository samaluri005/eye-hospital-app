PS /home/sam> az keyvault secret list --vault-name ehmsdevKeyVault9256b2 --query "[].name" -o table
(Forbidden) Caller is not authorized to perform action on resource.
If role assignments, deny assignments or role definitions were changed recently, please observe propagation time.
Caller: appid=b677c290-cf4b-4a8e-a60e-91ba650a4abe;oid=64e95573-d7e6-4b61-ac81-51dfb8d98ece;iss=https://sts.windows.net/2328c8fc-e1fb-4f12-9af1-0f50b28bb383/
Action: 'Microsoft.KeyVault/vaults/secrets/readMetadata/action'
Resource: '/subscriptions/e4ab82b7-b8fb-4e21-872c-d7281c479338/resourcegroups/ehmsdev-rg-9256b2/providers/microsoft.keyvault/vaults/ehmsdevkeyvault9256b2'
Assignment: (not found)
DenyAssignmentId: null
DecisionReason: null 
Vault: ehmsdevKeyVault9256b2;location=eastus

Code: Forbidden
Message: Caller is not authorized to perform action on resource.
If role assignments, deny assignments or role definitions were changed recently, please observe propagation time.
Caller: appid=b677c290-cf4b-4a8e-a60e-91ba650a4abe;oid=64e95573-d7e6-4b61-ac81-51dfb8d98ece;iss=https://sts.windows.net/2328c8fc-e1fb-4f12-9af1-0f50b28bb383/
Action: 'Microsoft.KeyVault/vaults/secrets/readMetadata/action'
Resource: '/subscriptions/e4ab82b7-b8fb-4e21-872c-d7281c479338/resourcegroups/ehmsdev-rg-9256b2/providers/microsoft.keyvault/vaults/ehmsdevkeyvault9256b2'
Assignment: (not found)
DenyAssignmentId: null
DecisionReason: null 
Vault: ehmsdevKeyVault9256b2;location=eastus

Inner error: {
    "code": "ForbiddenByRbac"
}
PS /home/sam> # Set variables                     
PS /home/sam> KV_NAME="ehmsdevKeyVault9256b2"
KV_NAME=ehmsdevKeyVault9256b2: The term 'KV_NAME=ehmsdevKeyVault9256b2' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
PS /home/sam> SP_APP_ID="4cf22fb5-ac52-4ee6-92f8-176c1db47182" 
SP_APP_ID=4cf22fb5-ac52-4ee6-92f8-176c1db47182: The term 'SP_APP_ID=4cf22fb5-ac52-4ee6-92f8-176c1db47182' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
PS /home/sam> SP_TENANT="2328c8fc-e1fb-4f12-9af1-0f50b28bb383"
SP_TENANT=2328c8fc-e1fb-4f12-9af1-0f50b28bb383: The term 'SP_TENANT=2328c8fc-e1fb-4f12-9af1-0f50b28bb383' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
PS /home/sam> 
PS /home/sam> # You'll need the service principal password from when it was created
PS /home/sam> # If you don't have it, we'll create a new one below
PS /home/sam> # Create new service principal specifically for GitHub Actions
PS /home/sam> SP_JSON=$(az ad sp create-for-rbac --name "github-actions-ehms-prod" --role contributor --scopes /subscriptions/e4ab82b7-b8fb-4e21-872c-d7281c479338 --sdk-auth)
SP_JSON=$(az ad sp create-for-rbac --name "github-actions-ehms-prod" --role contributor --scopes /subscriptions/e4ab82b7-b8fb-4e21-872c-d7281c479338 --sdk-auth): The term 'SP_JSON=$(az ad sp create-for-rbac --name "github-actions-ehms-prod" --role contributor --scopes /subscriptions/e4ab82b7-b8fb-4e21-872c-d7281c479338 --sdk-auth)' is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
PS /home/sam> 
PS /home/sam> # This will output the complete JSON you need for AZURE_CREDENTIALS
PS /home/sam> echo $SP_JSON
PS /home/sam> 